<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Master Console - Helton Alves</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;font-family:Arial,Helvetica,sans-serif;
background:#050505;color:#eee;
display:flex;justify-content:center;align-items:center;
height:100vh
}
.container{
width:95vw;max-width:1300px;
background:#111;border-radius:10px;
padding:15px;box-sizing:border-box
}
.header{
display:flex;justify-content:space-between;
align-items:center;border-bottom:1px solid #333;
padding-bottom:10px
}
.brand{font-size:1.5rem;font-weight:800}
.brand span{color:#00e5ff}
.actions button{
margin-left:8px;padding:8px 12px;
font-weight:700;cursor:pointer
}
.tabs{margin:10px 0;display:flex;gap:10px}
.tab{
padding:6px 20px;border:2px solid #333;
cursor:pointer;font-weight:700
}
.tab.active{background:#00e5ff;color:#000}
.grid{
display:grid;grid-template-columns:repeat(3,1fr);
gap:10px
}
.pad{
background:#1a1a1a;border:2px solid #333;
border-radius:8px;padding:10px;
height:130px;cursor:pointer;
position:relative
}
.pad.active{border-color:#00ff88}
.idx{position:absolute;top:6px;left:8px;color:#444}
.title{text-align:center;font-weight:700;margin-top:22px}
.menu{
position:absolute;top:6px;right:8px;
cursor:pointer;font-weight:bold
}
.ctx{
position:absolute;top:25px;right:8px;
background:#222;border:1px solid #555;
display:none;flex-direction:column;
z-index:10
}
.ctx div{
padding:8px 14px;font-size:.75rem;
cursor:pointer
}
.ctx div:hover{background:#00e5ff;color:#000}
.volume{
position:absolute;bottom:28px;left:10px;right:10px
}
.footer{
position:absolute;bottom:6px;left:10px;right:10px;
display:flex;justify-content:space-between;
font-size:.75rem
}
.footer-bar{
margin-top:10px;text-align:center;
font-size:.7rem;color:#777
}
</style>
</head>

<body>
<div class="container">

<div class="header">
<div class="brand">MASTER<span>CONSOLE</span></div>
<div class="actions">
<button onclick="stopAll()">STOP</button>
<button onclick="saveProject()">SALVAR</button>
<button onclick="fileLoad.click()">ABRIR</button>
<button onclick="clearCurrentBank()">LIMPAR BANCO</button>
<input type="file" id="fileLoad" accept=".json" hidden onchange="loadProject(event)">
</div>
</div>

<div class="tabs">
<div class="tab active" onclick="changeBank('A')">BANCO A</div>
<div class="tab" onclick="changeBank('B')">BANCO B</div>
<div class="tab" onclick="changeBank('C')">BANCO C</div>
</div>

<div class="grid" id="grid"></div>

<div class="footer-bar">
NUMPAD [1-9]: PLAY | [0]: STOP ALL<br>
Desenvolvido por <strong style="color:#00e5ff">
Helton Alves | Locutor Publicit√°rio</strong>
</div>

</div>

<script>
const audioCtx=new AudioContext();
let currentBank='A';

const banks={
A:{},B:{},C:{}
};

const sources={},gains={};
const grid=document.getElementById('grid');

for(let i=1;i<=9;i++){
const p=document.createElement('div');
p.className='pad';p.id='pad'+i;
p.innerHTML=`
<div class="idx">${i}</div>
<div class="menu" onclick="toggleMenu(event,${i})">‚ãÆ</div>
<div class="ctx" id="ctx${i}">
<div onclick="loadAudio(${i})">üìÅ CARREGAR</div>
<div onclick="clearPad(${i})">üóëÔ∏è LIMPAR</div>
</div>
<div class="title" id="title${i}">---</div>
<div class="volume">
<input type="range" min="0" max="1" step="0.01" value="1"
oninput="setVolume(${i},this.value)">
</div>
<div class="footer">
<span onclick="toggleLoop(${i})">üîÅ</span>
</div>
<input type="file" id="file${i}" accept="audio/*" hidden
onchange="handleFile(event,${i})">
`;
p.onclick=e=>{
if(!e.target.closest('.menu') && !e.target.closest('.ctx'))
playPad(i);
};
grid.appendChild(p);
}

function toggleMenu(e,i){
e.stopPropagation();
document.querySelectorAll('.ctx')
.forEach(c=>c.style.display='none');
document.getElementById('ctx'+i).style.display='flex';
}
window.onclick=()=>document
.querySelectorAll('.ctx')
.forEach(c=>c.style.display='none');

function loadAudio(i){
document.getElementById('file'+i).click();
}

function handleFile(e,i){
const file=e.target.files[0];
const reader=new FileReader();
reader.onload=()=>{
audioCtx.decodeAudioData(reader.result,b=>{
banks[currentBank][i]={
buffer:b,name:file.name,vol:1,loop:false
};
updateUI();
});
};
reader.readAsArrayBuffer(file);
}

function playPad(i){
stopPad(i);
const d=banks[currentBank][i];
if(!d)return;
const s=audioCtx.createBufferSource();
const g=audioCtx.createGain();
s.buffer=d.buffer;
s.loop=d.loop;
g.gain.value=d.vol;
s.connect(g).connect(audioCtx.destination);
s.start();
sources[i]=s;gains[i]=g;
document.getElementById('pad'+i).classList.add('active');
s.onended=()=>document
.getElementById('pad'+i).classList.remove('active');
}

function stopPad(i){
if(sources[i]){sources[i].stop();sources[i]=null;}
}
function stopAll(){Object.keys(sources).forEach(stopPad);}

function setVolume(i,v){
if(banks[currentBank][i])banks[currentBank][i].vol=v;
if(gains[i])gains[i].gain.value=v;
}

function toggleLoop(i){
if(banks[currentBank][i])
banks[currentBank][i].loop=!banks[currentBank][i].loop;
}

function clearPad(i){
stopPad(i);
delete banks[currentBank][i];
updateUI();
}

function clearCurrentBank(){
stopAll();
banks[currentBank]={};
updateUI();
}

function changeBank(b){
stopAll();
currentBank=b;
document.querySelectorAll('.tab')
.forEach(t=>t.classList.remove('active'));
document.querySelector(`.tab:nth-child(${b==='A'?1:b==='B'?2:3})`)
.classList.add('active');
updateUI();
}

function updateUI(){
for(let i=1;i<=9;i++){
document.getElementById('title'+i).innerText=
banks[currentBank][i]?.name||'---';
}
}

function saveProject(){
const data={
version:1,
banks:Object.fromEntries(
Object.entries(banks).map(([k,v])=>[
k,
Object.fromEntries(
Object.entries(v).map(([i,p])=>[
i,{name:p.name,vol:p.vol,loop:p.loop}
])
)
])
};
const blob=new Blob([JSON.stringify(data,null,2)],
{type:'application/json'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='master-console.json';
a.click();
}

function loadProject(e){
const file=e.target.files[0];
const r=new FileReader();
r.onload=()=>{
const data=JSON.parse(r.result);
for(const b of ['A','B','C']){
banks[b]={};
for(const i in data.banks[b]){
banks[b][i]={...data.banks[b][i]};
}
}
updateUI();
};
r.readAsText(file);
}

document.addEventListener('keydown',e=>{
if(e.key>='1'&&e.key<='9')playPad(+e.key);
if(e.key==='0')stopAll();
});
</script>
</body>
</html>

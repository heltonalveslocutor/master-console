<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Master Console - Helton Alves</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;font-family:Arial,Helvetica,sans-serif;
background:#050505;color:#eee;
display:flex;justify-content:center;align-items:center;
height:100vh
}
.container{
width:95vw;max-width:1300px;
background:#111;border-radius:10px;
padding:15px;box-sizing:border-box
}
.header{
display:flex;justify-content:space-between;
align-items:center;border-bottom:1px solid #333;
padding-bottom:10px
}
.brand{font-size:1.5rem;font-weight:800}
.brand span{color:#00e5ff}
.actions button{
margin-left:8px;padding:8px 12px;
font-weight:700;cursor:pointer
}
.tabs{margin:10px 0;display:flex;gap:10px}
.tab{
padding:6px 20px;border:2px solid #333;
cursor:pointer;font-weight:700
}
.tab.active{background:#00e5ff;color:#000}
.grid{
display:grid;grid-template-columns:repeat(3,1fr);
gap:10px
}
.pad{
background:#1a1a1a;border:2px solid #333;
border-radius:8px;padding:10px;
height:120px;cursor:pointer;
position:relative
}
.pad.active{border-color:#00ff88}
.idx{position:absolute;top:6px;left:8px;color:#444}
.title{text-align:center;font-weight:700;margin-top:20px}
.footer{
position:absolute;bottom:6px;left:10px;right:10px;
display:flex;justify-content:space-between;
font-size:.75rem
}
.menu{
position:absolute;top:6px;right:8px;
cursor:pointer;font-weight:bold
}
.ctx{
position:absolute;top:25px;right:8px;
background:#222;border:1px solid #555;
display:none;flex-direction:column;
z-index:10
}
.ctx div{
padding:8px 14px;font-size:.75rem;
cursor:pointer
}
.ctx div:hover{background:#00e5ff;color:#000}
.volume{
position:absolute;bottom:30px;left:10px;right:10px
}
.footer-bar{
margin-top:10px;text-align:center;
font-size:.7rem;color:#777
}
</style>
</head>

<body>
<div class="container">
<div class="header">
<div class="brand">MASTER<span>CONSOLE</span></div>
<div class="actions">
<button onclick="stopAll()">STOP</button>
<button onclick="saveProject()">SALVAR</button>
<button onclick="fileLoad.click()">ABRIR</button>
<button onclick="clearAll()">LIMPAR</button>
<input type="file" id="fileLoad" accept=".json" hidden onchange="loadProject(event)">
</div>
</div>

<div class="tabs">
<div class="tab active" onclick="changeBank('A')">BANCO A</div>
<div class="tab" onclick="changeBank('B')">BANCO B</div>
<div class="tab" onclick="changeBank('C')">BANCO C</div>
</div>

<div class="grid" id="grid"></div>

<div class="footer-bar">
NUMPAD [1-9]: PLAY | [0]: STOP ALL<br>
Desenvolvido por <strong style="color:#00e5ff">
Helton Alves | Locutor Publicit√°rio</strong>
</div>
</div>

<script>
const ctx=new AudioContext();
let currentBank='A';
const banks={A:{},B:{},C:{}};
const sources={},gains={},loops={};
const grid=document.getElementById('grid');

for(let i=1;i<=9;i++){
const p=document.createElement('div');
p.className='pad';p.id='pad'+i;
p.innerHTML=`
<div class="idx">${i}</div>
<div class="menu" onclick="toggleMenu(event,${i})">‚ãÆ</div>
<div class="ctx" id="ctx${i}">
<div onclick="loadAudio(${i})">üìÅ CARREGAR</div>
<div onclick="clearPad(${i})">üóëÔ∏è LIMPAR</div>
</div>
<div class="title" id="title${i}">---</div>
<div class="volume">
<input type="range" min="0" max="1" step="0.01" value="1"
oninput="setVolume(${i},this.value)">
</div>
<div class="footer">
<span id="loop${i}" onclick="toggleLoop(event,${i})">üîÅ</span>
</div>
<input type="file" id="file${i}" accept="audio/*" hidden
onchange="handleFile(event,${i})">
`;
p.onclick=e=>{
if(!e.target.closest('.menu') && !e.target.closest('.ctx'))
playPad(i);
};
grid.appendChild(p);
}

function toggleMenu(e,i){
e.stopPropagation();
document.getElementById('ctx'+i).style.display='flex';
}

window.onclick=()=>document
.querySelectorAll('.ctx')
.forEach(c=>c.style.display='none');

function loadAudio(i){
document.getElementById('file'+i).click();
}

function handleFile(e,i){
const file=e.target.files[0];
const reader=new FileReader();
reader.onload=()=>{
ctx.decodeAudioData(reader.result,b=>{
banks[currentBank][i]={buffer:b,name:file.name,vol:1,loop:false};
document.getElementById('title'+i).innerText=file.name;
});
};
reader.readAsArrayBuffer(file);
}

function playPad(i){
stopPad(i);
const data=banks[currentBank][i];
if(!data)return;
const src=ctx.createBufferSource();
const g=ctx.createGain();
src.buffer=data.buffer;
src.loop=data.loop;
g.gain.value=data.vol;
src.connect(g).connect(ctx.destination);
src.start();
sources[i]=src;gains[i]=g;
document.getElementById('pad'+i).classList.add('active');
src.onended=()=>document
.getElementById('pad'+i).classList.remove('active');
}

function stopPad(i){
if(sources[i]){sources[i].stop();sources[i]=null;}
}

function stopAll(){
Object.keys(sources).forEach(stopPad);
}

function setVolume(i,v){
if(gains[i])gains[i].gain.value=v;
if(banks[currentBank][i])banks[currentBank][i].vol=v;
}

function toggleLoop(e,i){
e.stopPropagation();
if(banks[currentBank][i]){
banks[currentBank][i].loop=!banks[currentBank][i].loop;
}
}

function clearPad(i){
stopPad(i);
delete banks[currentBank][i];
document.getElementById('title'+i).innerText='---';
}

function clearAll(){
stopAll();
banks.A={};banks.B={};banks.C={};
document.querySelectorAll('.title')
.forEach(t=>t.innerText='---');
}

function changeBank(b){
currentBank=b;
document.querySelectorAll('.tab')
.forEach(t=>t.classList.remove('active'));
document.querySelector(`.tab:nth-child(${b==='A'?1:b==='B'?2:3})`)
.classList.add('active');
document.querySelectorAll('.title')
.forEach(t=>t.innerText='---');
Object.keys(banks[b]).forEach(i=>{
document.getElementById('title'+i).innerText=banks[b][i].name;
});
}

function saveProject(){
const blob=new Blob([JSON.stringify(banks)],{type:'application/json'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='master-console.json';
a.click();
}

function loadProject(e){
const file=e.target.files[0];
const r=new FileReader();
r.onload=()=>{
const data=JSON.parse(r.result);
Object.assign(banks,data);
changeBank(currentBank);
};
r.readAsText(file);
}

document.addEventListener('keydown',e=>{
if(e.key>='1'&&e.key<='9')playPad(+e.key);
if(e.key==='0')stopAll();
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Master Console</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Rajdhani:wght@600;700&display=swap');

:root{
    --bg:#050505;--card:#111;--pad:#1a1a1a;
    --primary:#00e5ff;--accent:#00ff88;--danger:#ff4d4d;
    --text:#f0f0f0;--dim:#888;
}

body.pg-A{--primary:#00e5ff}
body.pg-B{--primary:#ffcc00}
body.pg-C{--primary:#d600ff}

body{
    margin:0;
    font-family:'Inter',sans-serif;
    background:var(--bg);
    color:var(--text);
    display:flex;
    justify-content:center;
    height:100vh;
}

.container{
    width:96vw;max-width:1350px;
    background:var(--card);
    margin:20px;
    padding:14px 25px;
    border-radius:14px;
    border:1px solid #333;
    display:flex;
    flex-direction:column;
    gap:10px;
}

.brand{
    font-family:'Rajdhani';
    font-size:1.6rem;
    font-weight:700;
}
.brand span{color:var(--primary)}

.top{
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.tabs{display:flex;gap:8px}
.tab{
    padding:6px 22px;
    border:2px solid #333;
    border-radius:6px;
    background:#1a1a1a;
    font-weight:800;
    cursor:pointer;
    color:var(--dim);
}
.tab.active{
    background:var(--primary);
    color:#000;
    border-color:var(--primary);
}

.master{
    display:grid;
    grid-template-columns:1fr 220px;
    gap:18px;
    padding:10px 16px;
    background:#000;
    border-radius:8px;
    border:1px solid #222;
    align-items:center;
}

.vu{
    height:10px;
    background:#111;
    border-radius:5px;
    overflow:hidden;
}
#vuFill{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#00ff88 70%,#ffcc00 85%,#ff3b3b);
}

.grid{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:12px;
}

.pad{
    background:var(--pad);
    border:2px solid #333;
    border-radius:12px;
    height:135px;
    padding:10px 14px;
    position:relative;
    cursor:pointer;
    display:flex;
    flex-direction:column;
    transition:.15s;
}

.pad.active{
    border-color:var(--accent);
    background:#080808;
    transform:translateY(-1px);
    box-shadow:0 0 20px rgba(0,255,136,.35);
}

.pad.active::after{
    content:'';
    position:absolute;
    inset:0;
    box-shadow:0 0 30px rgba(0,255,136,.2);
    animation:pulse 1.6s infinite;
}

@keyframes pulse{
    0%{opacity:.3}
    50%{opacity:.7}
    100%{opacity:.3}
}

.prog{
    position:absolute;
    inset:0;
    width:0%;
    background:rgba(0,255,136,.12);
    border-right:3px solid var(--accent);
    pointer-events:none;
    border-radius:10px 0 0 10px;
    transition:width .04s linear;
}

.idx{
    position:absolute;
    top:8px;left:12px;
    font-weight:800;
    color:#444;
}

.controls{
    position:absolute;
    top:6px;right:10px;
    display:flex;
    gap:8px;
}

.loop{
    background:none;
    border:none;
    cursor:pointer;
    color:#555;
}
.loop.active{color:var(--primary)}

.title{
    margin-top:18px;
    text-align:center;
    font-weight:800;
    color:var(--primary);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
}

.footer{
    margin-top:auto;
    display:flex;
    flex-direction:column;
    gap:4px;
}

.times{
    display:flex;
    justify-content:space-between;
    font-family:'Rajdhani';
    font-size:.85rem;
}

.vol{
    width:100%;
    accent-color:var(--primary);
}
</style>
</head>

<body class="pg-A">

<div class="container">

<div class="top">
    <div class="brand">MASTER<span>CONSOLE</span></div>
    <div class="tabs">
        <div class="tab active" onclick="page('A')">A</div>
        <div class="tab" onclick="page('B')">B</div>
        <div class="tab" onclick="page('C')">C</div>
    </div>
</div>

<div class="master">
    <div class="vu"><div id="vuFill"></div></div>
    <input type="range" min="0" max="1.5" step=".01" value="1"
           oninput="masterGain.gain.value=this.value">
</div>

<div class="grid" id="grid"></div>

</div>

<script>
const ctx=new AudioContext();
const masterGain=ctx.createGain();
const analyser=ctx.createAnalyser();
masterGain.connect(analyser);
analyser.connect(ctx.destination);

let pageNow='A';
let pads={},sources={};

const grid=document.getElementById('grid');

for(let i=1;i<=9;i++){
    grid.innerHTML+=`
    <div class="pad" id="pad${i}">
        <div class="prog" id="prog${i}"></div>
        <div class="idx">${i}</div>
        <div class="controls">
            <button class="loop" id="loop${i}">‚ü≥</button>
        </div>
        <div class="title" id="name${i}">---</div>
        <div class="footer">
            <div class="times">
                <span id="cur${i}">00:00</span>
                <span id="rem${i}">00:00</span>
            </div>
            <input class="vol" type="range" min="0" max="1" step=".01" value="1">
        </div>
        <input type="file" hidden id="file${i}" accept="audio/*">
    </div>`;
}

document.querySelectorAll('.pad').forEach((p,i)=>{
    const id=i+1;
    pads[id]={loop:false,vol:1};
    p.onclick=()=>play(id);
    p.ondblclick=()=>document.getElementById('file'+id).click();
    document.getElementById('loop'+id).onclick=e=>{
        e.stopPropagation();
        pads[id].loop=!pads[id].loop;
        e.target.classList.toggle('active',pads[id].loop);
    }
    p.querySelector('.vol').oninput=e=>pads[id].vol=e.target.value;
    document.getElementById('file'+id).onchange=async e=>{
        const f=e.target.files[0];
        const buf=await ctx.decodeAudioData(await f.arrayBuffer());
        pads[id].buf=buf;
        document.getElementById('name'+id).innerText=f.name.replace(/\..*/,'');
        document.getElementById('rem'+id).innerText=time(buf.duration);
    }
});

function play(id){
    if(!pads[id].buf)return;
    if(ctx.state==='suspended')ctx.resume();
    if(sources[id])return stop(id);

    const src=ctx.createBufferSource();
    const g=ctx.createGain();
    src.buffer=pads[id].buf;
    src.loop=pads[id].loop;
    g.gain.setValueAtTime(0,ctx.currentTime);
    g.gain.linearRampToValueAtTime(pads[id].vol,ctx.currentTime+.015);
    src.connect(g).connect(masterGain);
    src.start();
    sources[id]={src,g,start:ctx.currentTime};
    document.getElementById('pad'+id).classList.add('active');

    function anim(){
        if(!sources[id])return;
        let t=(ctx.currentTime-sources[id].start)%src.buffer.duration;
        document.getElementById('prog'+id).style.width=(t/src.buffer.duration*100)+'%';
        document.getElementById('cur'+id).innerText=time(t);
        document.getElementById('rem'+id).innerText='-'+time(src.buffer.duration-t);
        requestAnimationFrame(anim);
    }
    anim();

    src.onended=()=>!pads[id].loop&&stop(id);
}

function stop(id){
    const o=sources[id];
    if(!o)return;
    o.g.gain.linearRampToValueAtTime(0,ctx.currentTime+.02);
    setTimeout(()=>o.src.stop(),25);
    sources[id]=null;
    document.getElementById('pad'+id).classList.remove('active');
    document.getElementById('prog'+id).style.width='0%';
}

function page(p){
    pageNow=p;
    document.body.className='pg-'+p;
    document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active',t.innerText===p));
}

function time(s){
    const m=Math.floor(s/60),sc=Math.floor(s%60);
    return m.toString().padStart(2,'0')+':'+sc.toString().padStart(2,'0');
}

function vu(){
    const d=new Float32Array(analyser.fftSize);
    analyser.getFloatTimeDomainData(d);
    let sum=0;d.forEach(v=>sum+=v*v);
    const rms=Math.sqrt(sum/d.length);
    vuFill.style.width=Math.min(100,Math.max(0,(20*Math.log10(rms)+50)*2))+'%';
    requestAnimationFrame(vu);
}
vu();

window.onkeydown=e=>{
    if(e.key>=1&&e.key<=9)play(+e.key);
    if(e.key==='0')Object.keys(sources).forEach(stop);
}
</script>
</body>
</html>
